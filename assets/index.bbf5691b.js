import{J as X,S as D,ab as G,K as R,H as p,I as f,N as A,R as i,ac as M,M as c,O as l,P as w,G as V,L as b,Z as j,ad as Y,X as r,ae as Z,Y as H,a1 as z,T as J,af as Q,ag as W,ah as tt,$ as et}from"./index.6c2a73f9.js";import{t as C,A as at}from"./nftdata.2594166f.js";import{s as L,c as S,a as E}from"./function-call.d2cd2a41.js";const ot={class:"flex justify-between"},nt={class:"text-base ml-1 inline-block align-top"},st={key:0,class:"text-sm text-gray-500"},lt={key:1,class:"text-sm text-red-500"},rt={class:"text-base ml-1"},it=i("div",{class:"h-40"},null,-1),ut={class:"py-3"},mt={class:"mb-2 text-center"},ct={class:"inline-block align-top ml-1 text-gray-900 text-lg font-medium"},dt={class:"mx-auto text-center"},pt=X({__name:"NftCard",props:{title:String,thumb:String,amount:{type:Number,default:1},quality:{type:Number,default:1},race:{type:Number,default:1},level:{type:Number,default:1},lvPower:{type:Number,default:1},className:{type:Number,default:1},source:{type:Number,default:1},code:{type:Number,default:1001},tokenId:{type:Number,default:0}},emits:["onRefresh"],setup(O,{emit:s}){const t=O,{t:I}=D(),{address:e,signer:$}=G(),d=["border-gray-500","border-gray-500","border-green-500","border-blue-500","border-purple-500","border-yellow-500"],T=R(!1),k=R(""),U=R(1),F=()=>{U.value=t.amount,T.value=!0},P=async()=>{L({duration:0,message:I("common.Operation_progress")});try{t.tokenId==0?await(await new z(C.HeroNFT1155.address,C.HeroNFT1155.abi,$.value).safeTransferFrom(e.value,k.value,t.code,U.value,"0x00")).wait():await(await new z(C.HeroNFT.address,C.HeroNFT.abi,$.value).transferFrom(e.value,k.value,t.tokenId)).wait()}catch{S(),E("Error!")}S(),s("onRefresh")},q=async()=>{L({duration:0,forbidClick:!0,message:I("common.Operation_progress")});const m=C.NFTStaking.address,u=C.NFTStaking.abi;let g=new z(m,u,$.value);try{t.tokenId==0?await(await g.unstake([t.code],[t.amount],[])).wait():await(await g.unstake([],[],[t.tokenId])).wait()}catch{S(),E("Error!")}S(),s("onRefresh")};return(m,u)=>{const g=p("van-icon"),a=p("van-tag"),n=p("van-button"),y=p("van-cell"),_=p("van-field"),h=p("van-cell-group"),N=p("van-dialog");return f(),A(H,null,[i("div",{class:Y(["rounded-lg shadow-lg max-w-sm m-3 border-2",d[t.quality]])},[i("div",{class:"m-2 bg-no-repeat bg-cover bg-top",style:M("background-image: url("+t.thumb+"); background-position-y: -80px")},[i("div",ot,[i("div",null,[c(g,{name:"/static/images/race/"+t.race+".png"},null,8,["name"]),i("span",nt,"Lv."+l(t.level),1)]),t.source==1?(f(),A("div",st,l(m.$t("mynft.mine_pool")),1)):w("",!0),t.source==2?(f(),A("div",lt,l(m.$t("mynft.free")),1)):w("",!0),i("div",null,[c(g,{name:"/static/images/item/top_icon2.png"}),i("span",rt,l(t.lvPower),1)])]),it,i("div",ut,[i("div",mt,[c(g,{name:"/static/images/class/"+t.className+".png",size:"1.3rem"},null,8,["name"]),i("span",ct,l(t.title),1),t.amount>1?(f(),V(a,{key:0,class:"ml-1",color:"#111827",plain:""},{default:b(()=>[j("X"+l(t.amount),1)]),_:1})):w("",!0)]),i("div",dt,[t.source==1?(f(),V(n,{key:0,plain:"",type:"default",size:"small",icon:"paid-o",class:"mr-2",onClick:q},{default:b(()=>[j(l(m.$t("mynft.unstake")),1)]),_:1})):w("",!0),t.source==2?(f(),V(n,{key:1,type:"default",size:"small",icon:"share-o",onClick:F},{default:b(()=>[j(l(m.$t("mynft.transfer")),1)]),_:1})):w("",!0)])])],4)],2),c(N,{show:T.value,"onUpdate:show":u[2]||(u[2]=v=>T.value=v),title:m.$t("mynft.transfer"),"show-cancel-button":"",onConfirm:P},{default:b(()=>[c(h,{inset:""},{default:b(()=>[c(y,{title:m.$t("mynft.from_address"),value:r(e)},null,8,["title","value"]),c(y,{title:"NFT",value:t.title},null,8,["value"]),c(_,{modelValue:O.amount,"onUpdate:modelValue":u[0]||(u[0]=v=>Z(amount)?amount.value=v:null),type:"digit",label:m.$t("mynft.amount_transfer")},null,8,["modelValue","label"]),c(_,{modelValue:k.value,"onUpdate:modelValue":u[1]||(u[1]=v=>k.value=v),label:m.$t("mynft.to_address")},null,8,["modelValue","label"])]),_:1})]),_:1},8,["show","title"])],64)}}}),ft={class:"flex justify-between mx-4 my-2"},vt={class:"text-sm text-gray-500"},gt={class:"text-gray-900"},yt={class:"text-sm text-gray-500"},_t={class:"grid grid-cols-2 md:lg:xl:grid-cols-5 group bg-white shadow-xl shadow-neutral-100 border"},Nt=X({__name:"index",setup(O){const{t:s}=D(),{address:t,isActivated:I}=G();let e=J({nfts:[],limit:10,page:1,total:0,totalnft:0});const{onActivated:$}=Q();let d=J({source:0,quality:0,race:0});const T=[{text:s("mynft.all_status"),value:0},{text:s("mynft.mine_pool"),value:1},{text:s("mynft.free"),value:2}],k=[{text:s("mynft.all_quality"),value:0},{text:s("mynft.common"),value:1},{text:s("mynft.uncommon"),value:2},{text:s("mynft.rare"),value:3},{text:s("mynft.epic"),value:4},{text:s("mynft.legendary"),value:5}],U=[{text:s("mynft.all_races"),value:0},{text:s("mynft.human"),value:1},{text:s("mynft.orc"),value:2},{text:s("mynft.elf"),value:3},{text:s("mynft.undead"),value:4}],F=R(!1),P=async()=>{await u(t.value),E(s("common.Refresh_succeeded")),F.value=!1},q=async(a=0)=>{console.log(d.source),await u(t.value)},m=async()=>{console.log(e.page),await u(t.value)};$(async({address:a})=>{console.log("activate: ",a),await u(a)}),W(async()=>{console.log("activate: ",t.value),await u(t.value)});async function u(a=""){L({duration:0,forbidClick:!0,message:s("common.Updating_data")});const n=await g(a,d.quality,d.race,d.source,e.page,e.limit);e.nfts=n.nfts,e.limit=n.limit,e.page=n.page,e.total=n.total,e.totalnft=n.totalnft,S()}async function g(a="",n=0,y=0,_=0,h=1,N=20){if(a=="")return{nfts:[],limit:N,page:h,total:0,totalnft:0};let v=!0;_==3&&(v=!1,_=0);const x=await tt("https://service-q42yv3pc-1258577806.hk.apigw.tencentcs.com/release/",{url:"nft/inventory/list",pjson:{address:a,merge:v,page:{number:h,size:N},filter:{quality:n,race:y,source:_}}}),K=at(x.list);return console.log("res: ",x),{nfts:K,limit:x.limit,page:x.page,total:x.total,totalnft:x.totalnft}}return(a,n)=>{const y=p("van-dropdown-item"),_=p("van-dropdown-menu"),h=p("van-sticky"),N=p("van-pull-refresh"),v=p("van-pagination");return f(),A(H,null,[c(h,{"offset-top":40},{default:b(()=>[r(I)?(f(),V(_,{key:0},{default:b(()=>[c(y,{modelValue:r(d).source,"onUpdate:modelValue":n[0]||(n[0]=o=>r(d).source=o),options:T,onChange:q},null,8,["modelValue"]),c(y,{modelValue:r(d).quality,"onUpdate:modelValue":n[1]||(n[1]=o=>r(d).quality=o),options:k,onChange:q},null,8,["modelValue"]),c(y,{modelValue:r(d).race,"onUpdate:modelValue":n[2]||(n[2]=o=>r(d).race=o),options:U,onChange:q},null,8,["modelValue"])]),_:1})):w("",!0)]),_:1}),i("div",ft,[i("div",vt,[j(l(a.$t("mynft.total_NFT"))+"\uFF1A",1),i("span",gt,l(r(e).totalnft),1)]),i("div",yt,l(a.$t("mynft.total_of"))+l(r(e).total)+l(a.$t("mynft.items"))+"\uFF0C"+l(a.$t("mynft.per_page"))+l(r(e).limit)+l(a.$t("mynft.items"))+"\uFF0C"+l(a.$t("mynft.current"))+l(r(e).page)+l(a.$t("mynft.page")),1)]),c(N,{modelValue:F.value,"onUpdate:modelValue":n[3]||(n[3]=o=>F.value=o),onRefresh:P},{default:b(()=>[i("div",_t,[(f(!0),A(H,null,et(r(e).nfts,(o,B)=>(f(),V(pt,{key:"nft"+B,title:a.$t(o.name),thumb:"/static/images/"+o.code+".png",amount:o.amount,quality:o.quality,level:o.level,race:o.race,lvPower:o.lvPower,className:o.class,source:o.source,code:o.code,tokenId:o.tokenId,onOnRefresh:P},null,8,["title","thumb","amount","quality","level","race","lvPower","className","source","code","tokenId"]))),128))])]),_:1},8,["modelValue"]),r(e).total>0?(f(),V(v,{key:0,modelValue:r(e).page,"onUpdate:modelValue":n[4]||(n[4]=o=>r(e).page=o),"total-items":r(e).total,"items-per-page":r(e).limit,"show-page-size":3,"force-ellipses":"",onChange:m},null,8,["modelValue","total-items","items-per-page"])):w("",!0)],64)}}});export{Nt as default};
