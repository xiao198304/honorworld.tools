import{J as D,$ as G,ad as K,K as R,H as d,I as v,N as A,R as i,ae as W,M as m,O as l,P as b,G as V,L as g,W as j,Z as Y,S as r,af as Z,X as H,a3 as z,a0 as X,ag as Q,ah as tt,ai as et,Y as at}from"./index.1b7d6fd2.js";import{t as C,A as ot}from"./nftdata.39c824cb.js";import{s as L,c as S,a as E}from"./function-call.5a909c1b.js";const nt={class:"flex justify-between"},st={class:"text-base ml-1 inline-block align-top"},lt={key:0,class:"text-sm text-gray-500"},rt={key:1,class:"text-sm text-red-500"},it={class:"text-base ml-1"},ut=i("div",{class:"h-40"},null,-1),mt={class:"py-3"},ct={class:"mb-2 text-center"},dt={class:"inline-block align-top ml-1 text-gray-900 text-lg font-medium"},pt={class:"mx-auto text-center"},ft=D({__name:"NftCard",props:{title:String,thumb:String,amount:{type:Number,default:1},quality:{type:Number,default:1},race:{type:Number,default:1},level:{type:Number,default:1},lvPower:{type:Number,default:1},className:{type:Number,default:1},source:{type:Number,default:1},code:{type:Number,default:1001},tokenId:{type:Number,default:0}},emits:["onRefresh"],setup(O,{emit:s}){const t=O,{t:I}=G(),{address:e,signer:$}=K(),p=["border-gray-500","border-gray-500","border-green-500","border-blue-500","border-purple-500","border-yellow-500"],F=R(!1),k=R(""),U=R(1),T=()=>{U.value=t.amount,F.value=!0},P=async()=>{L({duration:0,message:I("common.Operation_progress")});try{t.tokenId==0?await(await new z(C.HeroNFT1155.address,C.HeroNFT1155.abi,$.value).safeTransferFrom(e.value,k.value,t.code,U.value,"0x00")).wait():await(await new z(C.HeroNFT.address,C.HeroNFT.abi,$.value).transferFrom(e.value,k.value,t.tokenId)).wait()}catch{S(),E("Error!")}S(),s("onRefresh")},q=async()=>{L({duration:0,forbidClick:!0,message:I("common.Operation_progress")});const c=C.NFTStaking.address,u=C.NFTStaking.abi;let y=new z(c,u,$.value);try{t.tokenId==0?await(await y.unstake([t.code],[t.amount],[])).wait():await(await y.unstake([],[],[t.tokenId])).wait()}catch{S(),E("Error!")}S(),s("onRefresh")};return(c,u)=>{const y=d("van-icon"),a=d("van-tag"),n=d("van-button"),_=d("van-cell"),w=d("van-field"),h=d("van-cell-group"),x=d("van-dialog");return v(),A(H,null,[i("div",{class:Y(["rounded-lg shadow-lg max-w-sm m-3 border-2",p[t.quality]])},[i("div",{class:"m-2 bg-no-repeat bg-cover bg-top",style:W("background-image: url("+t.thumb+"); background-position-y: -80px")},[i("div",nt,[i("div",null,[m(y,{name:"/static/images/race/"+t.race+".png"},null,8,["name"]),i("span",st,"Lv."+l(t.level),1)]),t.source==1?(v(),A("div",lt,l(c.$t("mynft.mine_pool")),1)):b("",!0),t.source==2?(v(),A("div",rt,l(c.$t("mynft.free")),1)):b("",!0),i("div",null,[m(y,{name:"/static/images/item/top_icon2.png"}),i("span",it,l(t.lvPower),1)])]),ut,i("div",mt,[i("div",ct,[m(y,{name:"/static/images/class/"+t.className+".png",size:"1.3rem"},null,8,["name"]),i("span",dt,l(t.title),1),t.amount>1?(v(),V(a,{key:0,class:"ml-1",color:"#111827",plain:""},{default:g(()=>[j("X"+l(t.amount),1)]),_:1})):b("",!0)]),i("div",pt,[t.source==1?(v(),V(n,{key:0,plain:"",type:"default",size:"small",icon:"paid-o",class:"mr-2",onClick:q},{default:g(()=>[j(l(c.$t("mynft.unstake")),1)]),_:1})):b("",!0),t.source==2?(v(),V(n,{key:1,type:"default",size:"small",icon:"share-o",onClick:T},{default:g(()=>[j(l(c.$t("mynft.transfer")),1)]),_:1})):b("",!0)])])],4)],2),m(x,{show:F.value,"onUpdate:show":u[2]||(u[2]=f=>F.value=f),title:c.$t("mynft.transfer"),"show-cancel-button":"",onConfirm:P},{default:g(()=>[m(h,{inset:""},{default:g(()=>[m(_,{title:c.$t("mynft.from_address"),value:r(e)},null,8,["title","value"]),m(_,{title:"NFT",value:t.title},null,8,["value"]),m(w,{modelValue:O.amount,"onUpdate:modelValue":u[0]||(u[0]=f=>Z(amount)?amount.value=f:null),type:"digit",label:c.$t("mynft.amount_transfer")},null,8,["modelValue","label"]),m(w,{modelValue:k.value,"onUpdate:modelValue":u[1]||(u[1]=f=>k.value=f),label:c.$t("mynft.to_address")},null,8,["modelValue","label"])]),_:1})]),_:1},8,["show","title"])],64)}}}),vt={class:"flex justify-between mx-4 my-2"},gt={class:"text-sm text-gray-500"},yt={class:"text-gray-900"},_t={class:"text-sm text-gray-500"},wt={class:"grid grid-cols-2 md:lg:xl:grid-cols-5 group bg-white shadow-xl shadow-neutral-100 border"},xt=D({__name:"index",setup(O){const{t:s}=G(),{address:t,isActivated:I}=K();let e=X({nfts:[],limit:10,page:1,total:0,totalnft:0});const{onActivated:$}=Q();let p=X({source:0,quality:0,race:0});const F=[{text:s("mynft.all_status"),value:0},{text:s("mynft.mine_pool"),value:1},{text:s("mynft.free"),value:2}],k=[{text:s("mynft.all_quality"),value:0},{text:s("mynft.common"),value:1},{text:s("mynft.uncommon"),value:2},{text:s("mynft.rare"),value:3},{text:s("mynft.epic"),value:4},{text:s("mynft.legendary"),value:5}],U=[{text:s("mynft.all_races"),value:0},{text:s("mynft.human"),value:1},{text:s("mynft.orc"),value:2},{text:s("mynft.elf"),value:3},{text:s("mynft.undead"),value:4}],T=R(!1),P=async()=>{await u(t.value),E(s("common.Refresh_succeeded")),T.value=!1},q=async(a=0)=>{console.log(p.source),await u(t.value)},c=async()=>{console.log(e.page),await u(t.value)};$(async({address:a})=>{console.log("activate: ",a),await u(a)}),tt(async()=>{console.log("activate: ",t.value),await u(t.value)});async function u(a=""){L({duration:0,forbidClick:!0,message:s("common.Updating_data")});const n=await y(a,p.quality,p.race,p.source,e.page,e.limit);e.nfts=n.nfts,e.limit=n.limit,e.page=n.page,e.total=n.total,e.totalnft=n.totalnft,S()}async function y(a="",n=0,_=0,w=0,h=1,x=20){if(a=="")return{nfts:[],limit:x,page:h,total:0,totalnft:0};let f=!0;w==3&&(f=!1,w=0);const N=await et("https://service-q42yv3pc-1258577806.hk.apigw.tencentcs.com/release/",{url:"nft/inventory/list",pjson:{address:a,merge:f,page:{number:h,size:x},filter:{quality:n,race:_,source:w}}}),M=ot(N.list);return console.log("res: ",N),{nfts:M,limit:N.limit,page:N.page,total:N.total,totalnft:N.totalnft}}return(a,n)=>{const _=d("van-dropdown-item"),w=d("van-dropdown-menu"),h=d("van-sticky"),x=d("van-pull-refresh"),f=d("van-icon"),B=d("van-pagination");return v(),A(H,null,[m(h,{"offset-top":40},{default:g(()=>[r(I)?(v(),V(w,{key:0},{default:g(()=>[m(_,{modelValue:r(p).source,"onUpdate:modelValue":n[0]||(n[0]=o=>r(p).source=o),options:F,onChange:q},null,8,["modelValue"]),m(_,{modelValue:r(p).quality,"onUpdate:modelValue":n[1]||(n[1]=o=>r(p).quality=o),options:k,onChange:q},null,8,["modelValue"]),m(_,{modelValue:r(p).race,"onUpdate:modelValue":n[2]||(n[2]=o=>r(p).race=o),options:U,onChange:q},null,8,["modelValue"])]),_:1})):b("",!0)]),_:1}),i("div",vt,[i("div",gt,[j(l(a.$t("mynft.total_NFT"))+"\uFF1A",1),i("span",yt,l(r(e).totalnft),1)]),i("div",_t,l(a.$t("mynft.total_of"))+l(r(e).total)+l(a.$t("mynft.items"))+"\uFF0C"+l(a.$t("mynft.per_page"))+l(r(e).limit)+l(a.$t("mynft.items"))+"\uFF0C"+l(a.$t("mynft.current"))+l(r(e).page)+l(a.$t("mynft.page")),1)]),m(x,{modelValue:T.value,"onUpdate:modelValue":n[3]||(n[3]=o=>T.value=o),onRefresh:P},{default:g(()=>[i("div",wt,[(v(!0),A(H,null,at(r(e).nfts,(o,J)=>(v(),V(ft,{key:"nft"+J,title:a.$t(o.name),thumb:"/static/images/"+o.code+".png",amount:o.amount,quality:o.quality,level:o.level,race:o.race,lvPower:o.lvPower,className:o.class,source:o.source,code:o.code,tokenId:o.tokenId,onOnRefresh:P},null,8,["title","thumb","amount","quality","level","race","lvPower","className","source","code","tokenId"]))),128))])]),_:1},8,["modelValue"]),r(e).total>0?(v(),V(B,{key:0,modelValue:r(e).page,"onUpdate:modelValue":n[4]||(n[4]=o=>r(e).page=o),"total-items":r(e).total,"items-per-page":r(e).limit,"show-page-size":3,"force-ellipses":"",onChange:c},{"prev-text":g(()=>[m(f,{name:"arrow-left"})]),"next-text":g(()=>[m(f,{name:"arrow"})]),_:1},8,["modelValue","total-items","items-per-page"])):b("",!0)],64)}}});export{xt as default};
