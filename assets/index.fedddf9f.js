import{J as O,ab as J,K as S,H as p,I as f,N as $,R as u,ac as G,M as c,O as i,P as b,G as N,L as _,Z as I,ad as K,X as l,ae as M,Y as B,a1 as j,S as Y,T as L,af as Z,ag as Q,ah as W,$ as ee}from"./index.14a0fdd2.js";import{t as C,A as te}from"./nftdata.7c17f356.js";import{s as z,c as E,a as ae}from"./function-call.aa8c3c8e.js";const oe={class:"flex justify-between"},ne={class:"text-base ml-1 inline-block align-top"},se={key:0,class:"text-sm text-gray-500"},le={key:1,class:"text-sm text-red-500"},ue={class:"text-base ml-1"},ie=u("div",{class:"h-40"},null,-1),re={class:"py-3"},ce={class:"mb-2 text-center"},me={class:"inline-block align-top ml-1 text-gray-900 text-lg font-medium"},de={class:"mx-auto text-center"},pe=I(" \u89E3\u8D28\u62BC "),fe=I(" \u8F6C\u8D26 "),ve=O({__name:"NftCard",props:{title:String,thumb:String,amount:{type:Number,default:1},quality:{type:Number,default:1},race:{type:Number,default:1},level:{type:Number,default:1},lvPower:{type:Number,default:1},className:{type:Number,default:1},source:{type:Number,default:1},code:{type:Number,default:1001},tokenId:{type:Number,default:0}},emits:["onRefresh"],setup(U,{emit:s}){const e=U,{address:F,signer:t}=J(),P=["border-gray-500","border-gray-500","border-green-500","border-blue-500","border-purple-500","border-yellow-500"],r=S(!1),k=S(""),q=S(1),R=()=>{q.value=e.amount,r.value=!0},V=async()=>{z({duration:0,message:"\u64CD\u4F5C\u8FDB\u884C\u4E2D..."}),e.tokenId==0?await(await new j(C.HeroNFT1155.address,C.HeroNFT1155.abi,t.value).safeTransferFrom(F.value,k.value,e.code,q.value,"0x00")).wait():await(await new j(C.HeroNFT.address,C.HeroNFT.abi,t.value).transferFrom(F.value,k.value,e.tokenId)).wait(),E(),s("onRefresh")},A=async()=>{z({duration:0,forbidClick:!0,message:"\u64CD\u4F5C\u8FDB\u884C\u4E2D..."});const g=C.NFTStaking.address,m=C.NFTStaking.abi;E();let d=new j(g,m,t.value);e.tokenId==0?await(await d.unstake([e.code],[e.amount],[])).wait():await(await d.unstake([],[],[e.tokenId])).wait(),s("onRefresh")};return(g,m)=>{const d=p("van-icon"),T=p("van-tag"),n=p("van-button"),o=p("van-cell"),y=p("van-field"),w=p("van-cell-group"),h=p("van-dialog");return f(),$(B,null,[u("div",{class:K(["rounded-lg shadow-lg max-w-sm m-3 border-2",P[e.quality]])},[u("div",{class:"m-2 bg-no-repeat bg-cover bg-top",style:G("background-image: url("+e.thumb+"); background-position-y: -80px")},[u("div",oe,[u("div",null,[c(d,{name:"/static/images/race/"+e.race+".png"},null,8,["name"]),u("span",ne,"Lv."+i(e.level),1)]),e.source==1?(f(),$("div",se,"\u6316\u77FF")):b("",!0),e.source==2?(f(),$("div",le,"\u7A7A\u95F2")):b("",!0),u("div",null,[c(d,{name:"/static/images/item/top_icon2.png"}),u("span",ue,i(e.lvPower),1)])]),ie,u("div",re,[u("div",ce,[c(d,{name:"/static/images/class/"+e.className+".png",size:"1.3rem"},null,8,["name"]),u("span",me,i(e.title),1),e.amount>1?(f(),N(T,{key:0,class:"ml-1",color:"#111827",plain:""},{default:_(()=>[I("X"+i(e.amount),1)]),_:1})):b("",!0)]),u("div",de,[e.source==1?(f(),N(n,{key:0,plain:"",type:"default",size:"small",icon:"paid-o",class:"mr-2",onClick:A},{default:_(()=>[pe]),_:1})):b("",!0),e.source==2?(f(),N(n,{key:1,type:"default",size:"small",icon:"share-o",onClick:R},{default:_(()=>[fe]),_:1})):b("",!0)])])],4)],2),c(h,{show:r.value,"onUpdate:show":m[2]||(m[2]=v=>r.value=v),title:"\u6807\u9898","show-cancel-button":"",onConfirm:V},{default:_(()=>[c(w,{inset:""},{default:_(()=>[c(o,{title:"\u5F53\u524D\u5730\u5740",value:l(F)},null,8,["value"]),c(o,{title:"NFT",value:e.title},null,8,["value"]),c(y,{modelValue:U.amount,"onUpdate:modelValue":m[0]||(m[0]=v=>M(amount)?amount.value=v:null),type:"digit",label:"\u8F6C\u8D26\u6570\u91CF"},null,8,["modelValue"]),c(y,{modelValue:k.value,"onUpdate:modelValue":m[1]||(m[1]=v=>k.value=v),label:"\u63A5\u53D7\u5730\u5740"},null,8,["modelValue"])]),_:1})]),_:1},8,["show"])],64)}}}),ge={class:"flex justify-between mx-4 my-2"},ye={class:"text-sm text-gray-500"},_e={class:"text-gray-900"},we={class:"text-sm text-gray-500"},be={class:"grid grid-cols-2 md:lg:xl:grid-cols-5 group bg-white shadow-xl shadow-neutral-100 border"},Ne=O({__name:"index",setup(U){const{t:s}=Y(),{address:e,isActivated:F}=J();let t=L({nfts:[],limit:10,page:1,total:0,totalnft:0});const{onActivated:P}=Z();let r=L({source:0,quality:0,race:0});const k=[{text:s("mynft.all_status"),value:0},{text:s("mynft.mine_pool"),value:1},{text:s("mynft.free"),value:2}],q=[{text:s("mynft.all_quality"),value:0},{text:s("mynft.common"),value:1},{text:s("mynft.uncommon"),value:2},{text:s("mynft.rare"),value:3},{text:s("mynft.epic"),value:4},{text:s("mynft.legendary"),value:5}],R=[{text:s("mynft.all_races"),value:0},{text:s("mynft.human"),value:1},{text:s("mynft.orc"),value:2},{text:s("mynft.elf"),value:3},{text:s("mynft.undead"),value:4}],V=S(!1),A=async()=>{await d(e.value),ae(s("common.Refresh_succeeded")),V.value=!1},g=async(n=0)=>{console.log(r.source),await d(e.value)},m=async()=>{console.log(t.page),await d(e.value)};P(async({address:n})=>{console.log("activate: ",n),await d(n)}),Q(async()=>{console.log("activate: ",e.value),await d(e.value)});async function d(n=""){z({duration:0,forbidClick:!0,message:s("common.Updating_data")});const o=await T(n,r.quality,r.race,r.source,t.page,t.limit);t.nfts=o.nfts,t.limit=o.limit,t.page=o.page,t.total=o.total,t.totalnft=o.totalnft,E()}async function T(n="",o=0,y=0,w=0,h=1,v=20){if(n=="")return{nfts:[],limit:v,page:h,total:0,totalnft:0};let D=!0;w==3&&(D=!1,w=0);const x=await W("https://service-q42yv3pc-1258577806.hk.apigw.tencentcs.com/release/",{url:"nft/inventory/list",pjson:{address:n,merge:D,page:{number:h,size:v},filter:{quality:o,race:y,source:w}}}),X=te(x.list);return console.log("res: ",x),{nfts:X,limit:x.limit,page:x.page,total:x.total,totalnft:x.totalnft}}return(n,o)=>{const y=p("van-dropdown-item"),w=p("van-dropdown-menu"),h=p("van-sticky"),v=p("van-pull-refresh"),D=p("van-pagination");return f(),$(B,null,[c(h,{"offset-top":40},{default:_(()=>[l(F)?(f(),N(w,{key:0},{default:_(()=>[c(y,{modelValue:l(r).source,"onUpdate:modelValue":o[0]||(o[0]=a=>l(r).source=a),options:k,onChange:g},null,8,["modelValue"]),c(y,{modelValue:l(r).quality,"onUpdate:modelValue":o[1]||(o[1]=a=>l(r).quality=a),options:q,onChange:g},null,8,["modelValue"]),c(y,{modelValue:l(r).race,"onUpdate:modelValue":o[2]||(o[2]=a=>l(r).race=a),options:R,onChange:g},null,8,["modelValue"])]),_:1})):b("",!0)]),_:1}),u("div",ge,[u("div",ye,[I(i(n.$t("mynft.total_NFT"))+"\uFF1A",1),u("span",_e,i(l(t).totalnft),1)]),u("div",we,i(n.$t("mynft.total_of"))+i(l(t).total)+i(n.$t("mynft.items"))+"\uFF0C"+i(n.$t("mynft.per_page"))+i(l(t).limit)+i(n.$t("mynft.items"))+"\uFF0C"+i(n.$t("mynft.current"))+i(l(t).page)+i(n.$t("mynft.page")),1)]),c(v,{modelValue:V.value,"onUpdate:modelValue":o[3]||(o[3]=a=>V.value=a),onRefresh:A},{default:_(()=>[u("div",be,[(f(!0),$(B,null,ee(l(t).nfts,(a,H)=>(f(),N(ve,{key:"nft"+H,title:n.$t(a.name),thumb:"/static/images/"+a.code+".png",amount:a.amount,quality:a.quality,level:a.level,race:a.race,lvPower:a.lvPower,className:a.class,source:a.source,code:a.code,tokenId:a.tokenId,onOnRefresh:A},null,8,["title","thumb","amount","quality","level","race","lvPower","className","source","code","tokenId"]))),128))])]),_:1},8,["modelValue"]),l(t).total>0?(f(),N(D,{key:0,modelValue:l(t).page,"onUpdate:modelValue":o[4]||(o[4]=a=>l(t).page=a),"total-items":l(t).total,"items-per-page":l(t).limit,"show-page-size":3,"force-ellipses":"",onChange:m},null,8,["modelValue","total-items","items-per-page"])):b("",!0)],64)}}});export{Ne as default};
