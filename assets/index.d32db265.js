import{J,aa as R,K as S,H as c,I as d,N as T,R as l,ab as X,M as r,O as C,P as y,G as F,L as p,Y as V,ac as G,W as n,ad as K,X as L,a9 as z,T as O,ae as M,af as W,Z as Y}from"./index.a49b4198.js";import{s as E,c as q,t as x,a as Z,A as Q,b as ee}from"./request.c8cce62e.js";const te={class:"flex justify-between"},ae={class:"text-base ml-1 inline-block align-top"},oe={key:0,class:"text-sm text-gray-500"},se={key:1,class:"text-sm text-red-500"},ne={class:"text-base ml-1"},le=l("div",{class:"h-40"},null,-1),ue={class:"py-3"},ie={class:"mb-2 text-center"},re={class:"inline-block align-top ml-1 text-gray-900 text-lg font-medium"},ce={class:"mx-auto text-center"},de=V(" \u89E3\u8D28\u62BC "),me=V(" \u8D28\u62BC "),pe=V(" \u8F6C\u8D26 "),ve=J({__name:"NftCard",props:{title:String,thumb:String,amount:{type:Number,default:1},quality:{type:Number,default:1},race:{type:Number,default:1},level:{type:Number,default:1},lvPower:{type:Number,default:1},className:{type:Number,default:1},source:{type:Number,default:1},code:{type:Number,default:1001}},setup(U){const e=U,{address:A,signer:t}=R(),P=["border-gray-500","border-gray-500","border-green-500","border-blue-500","border-purple-500","border-yellow-500"],i=S(!1),h=S(""),B=S(1),$=()=>{B.value=e.amount,i.value=!0},N=async()=>{E({duration:0,forbidClick:!0,message:"\u64CD\u4F5C\u8FDB\u884C\u4E2D..."});const v=x.HeroNFT1155.address,s=x.HeroNFT1155.abi;await(await new z(v,s,t.value).safeTransferFrom(A.value,h.value,e.code,B.value,"0x00")).wait(),q()},j=async()=>{E({duration:0,forbidClick:!0,message:"\u64CD\u4F5C\u8FDB\u884C\u4E2D..."});const v=x.NFTStaking.address,s=x.NFTStaking.abi;await(await new z(v,s,t.value).unstake([e.code],[e.amount],[])).wait(),q()},D=async()=>{E({duration:0,forbidClick:!0,message:"\u64CD\u4F5C\u8FDB\u884C\u4E2D..."});const v=x.NFTStaking.address,s=x.NFTStaking.abi;await(await new z(v,s,t.value).stake([e.code],[e.amount],[])).wait(),q()};return(v,s)=>{const g=c("van-icon"),u=c("van-tag"),a=c("van-button"),_=c("van-cell"),f=c("van-field"),b=c("van-cell-group"),k=c("van-dialog");return d(),T(L,null,[l("div",{class:G(["rounded-lg shadow-lg max-w-sm m-3 border-2",P[e.quality]])},[l("div",{class:"m-2 bg-no-repeat bg-cover bg-top",style:X("background-image: url("+e.thumb+"); background-position-y: -80px")},[l("div",te,[l("div",null,[r(g,{name:"/static/images/race/"+e.race+".png"},null,8,["name"]),l("span",ae,"Lv."+C(e.level),1)]),e.source==1?(d(),T("div",oe,"\u6316\u77FF")):y("",!0),e.source==2?(d(),T("div",se,"\u7A7A\u95F2")):y("",!0),l("div",null,[r(g,{name:"/static/images/item/top_icon2.png"}),l("span",ne,C(e.lvPower),1)])]),le,l("div",ue,[l("div",ie,[r(g,{name:"/static/images/class/"+e.className+".png",size:"1.3rem"},null,8,["name"]),l("span",re,C(e.title),1),e.amount>1?(d(),F(u,{key:0,class:"ml-1",color:"#111827",plain:""},{default:p(()=>[V("X"+C(e.amount),1)]),_:1})):y("",!0)]),l("div",ce,[e.source==1?(d(),F(a,{key:0,plain:"",type:"default",size:"small",icon:"paid-o",class:"mr-2",onClick:j},{default:p(()=>[de]),_:1})):y("",!0),e.source==2?(d(),F(a,{key:1,plain:"",type:"default",size:"small",icon:"shield-o",class:"mr-2",onClick:D},{default:p(()=>[me]),_:1})):y("",!0),e.source==2?(d(),F(a,{key:2,type:"default",size:"small",icon:"share-o",onClick:$},{default:p(()=>[pe]),_:1})):y("",!0)])])],4)],2),r(k,{show:i.value,"onUpdate:show":s[2]||(s[2]=m=>i.value=m),title:"\u6807\u9898","show-cancel-button":"",onConfirm:N},{default:p(()=>[r(b,{inset:""},{default:p(()=>[r(_,{title:"\u5F53\u524D\u5730\u5740",value:n(A)},null,8,["value"]),r(_,{title:"NFT",value:e.title},null,8,["value"]),r(f,{modelValue:U.amount,"onUpdate:modelValue":s[0]||(s[0]=m=>K(amount)?amount.value=m:null),type:"digit",label:"\u8F6C\u8D26\u6570\u91CF"},null,8,["modelValue"]),r(f,{modelValue:h.value,"onUpdate:modelValue":s[1]||(s[1]=m=>h.value=m),label:"\u63A5\u53D7\u5730\u5740"},null,8,["modelValue"])]),_:1})]),_:1},8,["show"])],64)}}}),ge={class:"flex justify-between mx-4 my-2"},_e={class:"text-sm text-gray-500"},fe=V("NFT\u603B\u6570\uFF1A"),ye={class:"text-gray-900"},Ce={class:"text-sm text-gray-500"},Fe={class:"grid grid-cols-2 md:lg:xl:grid-cols-5 group bg-white shadow-xl shadow-neutral-100 border"},xe=J({__name:"index",setup(U){const{address:e,isActivated:A}=R();let t=O({nfts:[],limit:10,page:1,total:0,totalnft:0});const{onActivated:P}=M();let i=O({source:0,quality:0,race:0});const h=[{text:"\u5168\u90E8\u72B6\u6001",value:0},{text:"\u77FF\u6C60",value:1},{text:"\u7A7A\u95F2",value:2}],B=[{text:"\u5168\u90E8\u54C1\u8D28",value:0},{text:"\u666E\u901A",value:1},{text:"\u826F\u597D",value:2},{text:"\u7A00\u6709",value:3},{text:"\u53F2\u8BD7",value:4},{text:"\u4F20\u8BF4",value:5},{text:"\u795E\u8BDD",value:6}],$=[{text:"\u5168\u90E8\u79CD\u65CF",value:0},{text:"\u4EBA\u65CF",value:1},{text:"\u517D\u65CF",value:2},{text:"\u7CBE\u7075\u65CF",value:3},{text:"\u4E0D\u6B7B\u65CF",value:4}],N=S(!1),j=async()=>{await s(e.value),ee("\u5237\u65B0\u6210\u529F"),N.value=!1},D=async(u=0)=>{console.log(i.source),await s(e.value)},v=async()=>{console.log(t.page),await s(e.value)};P(async({address:u})=>{console.log("activate: ",u),await s(u)}),W(async()=>{console.log("activate: ",e.value),await s(e.value)});async function s(u=""){E({duration:0,forbidClick:!0,message:"\u6570\u636E\u66F4\u65B0\u4E2D..."});const a=await g(u,i.quality,i.race,i.source,t.page,t.limit);t.nfts=a.nfts,t.limit=a.limit,t.page=a.page,t.total=a.total,t.totalnft=a.totalnft,q()}async function g(u="",a=0,_=0,f=0,b=1,k=20){if(u=="")return{nfts:[],limit:k,page:b,total:0,totalnft:0};let m=!0;f==3&&(m=!1,f=0);const w=await Z("https://service-q42yv3pc-1258577806.hk.apigw.tencentcs.com/release/",{url:"nft/inventory/list",pjson:{address:u,merge:m,page:{number:b,size:k},filter:{quality:a,race:_,source:f}}}),I=Q(w.list);return console.log("res: ",w),{nfts:I,limit:w.limit,page:w.page,total:w.total,totalnft:w.totalnft}}return(u,a)=>{const _=c("van-dropdown-item"),f=c("van-dropdown-menu"),b=c("van-sticky"),k=c("van-pull-refresh"),m=c("van-pagination");return d(),T(L,null,[r(b,{"offset-top":40},{default:p(()=>[n(A)?(d(),F(f,{key:0},{default:p(()=>[r(_,{modelValue:n(i).source,"onUpdate:modelValue":a[0]||(a[0]=o=>n(i).source=o),options:h,onChange:D},null,8,["modelValue"]),r(_,{modelValue:n(i).quality,"onUpdate:modelValue":a[1]||(a[1]=o=>n(i).quality=o),options:B,onChange:D},null,8,["modelValue"]),r(_,{modelValue:n(i).race,"onUpdate:modelValue":a[2]||(a[2]=o=>n(i).race=o),options:$,onChange:D},null,8,["modelValue"])]),_:1})):y("",!0)]),_:1}),l("div",ge,[l("div",_e,[fe,l("span",ye,C(n(t).totalnft),1)]),l("div",Ce,"\u5171"+C(n(t).total)+"\u6761\uFF0C\u6BCF\u9875"+C(n(t).limit)+"\u6761\uFF0C\u5F53\u524D\u7B2C"+C(n(t).page)+"\u9875",1)]),r(k,{modelValue:N.value,"onUpdate:modelValue":a[3]||(a[3]=o=>N.value=o),onRefresh:j},{default:p(()=>[l("div",Fe,[(d(!0),T(L,null,Y(n(t).nfts,(o,H)=>(d(),F(ve,{key:"nft"+H,title:u.$t(o.name),thumb:"/static/images/"+o.code+".png",amount:o.amount,quality:o.quality,level:o.level,race:o.race,lvPower:o.lvPower,className:o.class,source:o.source,code:o.code},null,8,["title","thumb","amount","quality","level","race","lvPower","className","source","code"]))),128))])]),_:1},8,["modelValue"]),n(t).total>0?(d(),F(m,{key:0,modelValue:n(t).page,"onUpdate:modelValue":a[4]||(a[4]=o=>n(t).page=o),"total-items":n(t).total,"items-per-page":n(t).limit,"show-page-size":3,"force-ellipses":"",onChange:v},null,8,["modelValue","total-items","items-per-page"])):y("",!0)],64)}}});export{xe as default};
