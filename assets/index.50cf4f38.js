import{J as O,ab as J,K as A,H as c,I as d,N as V,R as n,ac as X,M as u,O as f,P as b,G as k,L as _,Z as E,ad as G,X as s,ae as K,Y as P,a1 as I,T as H,af as M,ag as Y,ah as Z,$ as Q}from"./index.4f482a85.js";import{t as x,A as W}from"./nftdata.a6134733.js";import{s as j,c as L,a as ee}from"./function-call.68fa2a7e.js";const te={class:"flex justify-between"},ae={class:"text-base ml-1 inline-block align-top"},oe={key:0,class:"text-sm text-gray-500"},se={key:1,class:"text-sm text-red-500"},ne={class:"text-base ml-1"},le=n("div",{class:"h-40"},null,-1),ue={class:"py-3"},ie={class:"mb-2 text-center"},re={class:"inline-block align-top ml-1 text-gray-900 text-lg font-medium"},ce={class:"mx-auto text-center"},de=E(" \u89E3\u8D28\u62BC "),me=E(" \u8F6C\u8D26 "),pe=O({__name:"NftCard",props:{title:String,thumb:String,amount:{type:Number,default:1},quality:{type:Number,default:1},race:{type:Number,default:1},level:{type:Number,default:1},lvPower:{type:Number,default:1},className:{type:Number,default:1},source:{type:Number,default:1},code:{type:Number,default:1001},tokenId:{type:Number,default:0}},setup(q){const e=q,{address:h,signer:t}=J(),S=["border-gray-500","border-gray-500","border-green-500","border-blue-500","border-purple-500","border-yellow-500"],l=A(!1),C=A(""),T=A(1),U=()=>{T.value=e.amount,l.value=!0},N=async()=>{j({duration:0,forbidClick:!0,message:"\u64CD\u4F5C\u8FDB\u884C\u4E2D..."}),e.tokenId==0?await(await new I(x.HeroNFT1155.address,x.HeroNFT1155.abi,t.value).safeTransferFrom(h.value,C.value,e.code,T.value,"0x00")).wait():await(await new I(x.HeroNFT.address,x.HeroNFT.abi,t.value).safeTransferFrom(h.value,C.value,e.tokenId)).wait(),L()},$=async()=>{j({duration:0,forbidClick:!0,message:"\u64CD\u4F5C\u8FDB\u884C\u4E2D..."});const v=x.NFTStaking.address,r=x.NFTStaking.abi;await(await new I(v,r,t.value).unstake([e.code],[e.amount],[],{gasLimit:5e5})).wait(),L()};return(v,r)=>{const m=c("van-icon"),D=c("van-tag"),i=c("van-button"),o=c("van-cell"),g=c("van-field"),y=c("van-cell-group"),F=c("van-dialog");return d(),V(P,null,[n("div",{class:G(["rounded-lg shadow-lg max-w-sm m-3 border-2",S[e.quality]])},[n("div",{class:"m-2 bg-no-repeat bg-cover bg-top",style:X("background-image: url("+e.thumb+"); background-position-y: -80px")},[n("div",te,[n("div",null,[u(m,{name:"/static/images/race/"+e.race+".png"},null,8,["name"]),n("span",ae,"Lv."+f(e.level),1)]),e.source==1?(d(),V("div",oe,"\u6316\u77FF")):b("",!0),e.source==2?(d(),V("div",se,"\u7A7A\u95F2")):b("",!0),n("div",null,[u(m,{name:"/static/images/item/top_icon2.png"}),n("span",ne,f(e.lvPower),1)])]),le,n("div",ue,[n("div",ie,[u(m,{name:"/static/images/class/"+e.className+".png",size:"1.3rem"},null,8,["name"]),n("span",re,f(e.title),1),e.amount>1?(d(),k(D,{key:0,class:"ml-1",color:"#111827",plain:""},{default:_(()=>[E("X"+f(e.amount),1)]),_:1})):b("",!0)]),n("div",ce,[e.source==1?(d(),k(i,{key:0,plain:"",type:"default",size:"small",icon:"paid-o",class:"mr-2",onClick:$},{default:_(()=>[de]),_:1})):b("",!0),e.source==2?(d(),k(i,{key:1,type:"default",size:"small",icon:"share-o",onClick:U},{default:_(()=>[me]),_:1})):b("",!0)])])],4)],2),u(F,{show:l.value,"onUpdate:show":r[2]||(r[2]=p=>l.value=p),title:"\u6807\u9898","show-cancel-button":"",onConfirm:N},{default:_(()=>[u(y,{inset:""},{default:_(()=>[u(o,{title:"\u5F53\u524D\u5730\u5740",value:s(h)},null,8,["value"]),u(o,{title:"NFT",value:e.title},null,8,["value"]),u(g,{modelValue:q.amount,"onUpdate:modelValue":r[0]||(r[0]=p=>K(amount)?amount.value=p:null),type:"digit",label:"\u8F6C\u8D26\u6570\u91CF"},null,8,["modelValue"]),u(g,{modelValue:C.value,"onUpdate:modelValue":r[1]||(r[1]=p=>C.value=p),label:"\u63A5\u53D7\u5730\u5740"},null,8,["modelValue"])]),_:1})]),_:1},8,["show"])],64)}}}),ve={class:"flex justify-between mx-4 my-2"},ge={class:"text-sm text-gray-500"},_e=E("NFT\u603B\u6570\uFF1A"),fe={class:"text-gray-900"},ye={class:"text-sm text-gray-500"},be={class:"grid grid-cols-2 md:lg:xl:grid-cols-5 group bg-white shadow-xl shadow-neutral-100 border"},ke=O({__name:"index",setup(q){const{address:e,isActivated:h}=J();let t=H({nfts:[],limit:10,page:1,total:0,totalnft:0});const{onActivated:S}=M();let l=H({source:0,quality:0,race:0});const C=[{text:"\u5168\u90E8\u72B6\u6001",value:0},{text:"\u77FF\u6C60",value:1},{text:"\u7A7A\u95F2",value:2}],T=[{text:"\u5168\u90E8\u54C1\u8D28",value:0},{text:"\u666E\u901A",value:1},{text:"\u826F\u597D",value:2},{text:"\u7A00\u6709",value:3},{text:"\u53F2\u8BD7",value:4},{text:"\u4F20\u8BF4",value:5},{text:"\u795E\u8BDD",value:6}],U=[{text:"\u5168\u90E8\u79CD\u65CF",value:0},{text:"\u4EBA\u65CF",value:1},{text:"\u517D\u65CF",value:2},{text:"\u7CBE\u7075\u65CF",value:3},{text:"\u4E0D\u6B7B\u65CF",value:4}],N=A(!1),$=async()=>{await m(e.value),ee("\u5237\u65B0\u6210\u529F"),N.value=!1},v=async(i=0)=>{console.log(l.source),await m(e.value)},r=async()=>{console.log(t.page),await m(e.value)};S(async({address:i})=>{console.log("activate: ",i),await m(i)}),Y(async()=>{console.log("activate: ",e.value),await m(e.value)});async function m(i=""){j({duration:0,forbidClick:!0,message:"\u6570\u636E\u66F4\u65B0\u4E2D..."});const o=await D(i,l.quality,l.race,l.source,t.page,t.limit);t.nfts=o.nfts,t.limit=o.limit,t.page=o.page,t.total=o.total,t.totalnft=o.totalnft,L()}async function D(i="",o=0,g=0,y=0,F=1,p=20){if(i=="")return{nfts:[],limit:p,page:F,total:0,totalnft:0};let B=!0;y==3&&(B=!1,y=0);const w=await Z("https://service-q42yv3pc-1258577806.hk.apigw.tencentcs.com/release/",{url:"nft/inventory/list",pjson:{address:i,merge:B,page:{number:F,size:p},filter:{quality:o,race:g,source:y}}}),R=W(w.list);return console.log("res: ",w),{nfts:R,limit:w.limit,page:w.page,total:w.total,totalnft:w.totalnft}}return(i,o)=>{const g=c("van-dropdown-item"),y=c("van-dropdown-menu"),F=c("van-sticky"),p=c("van-pull-refresh"),B=c("van-pagination");return d(),V(P,null,[u(F,{"offset-top":40},{default:_(()=>[s(h)?(d(),k(y,{key:0},{default:_(()=>[u(g,{modelValue:s(l).source,"onUpdate:modelValue":o[0]||(o[0]=a=>s(l).source=a),options:C,onChange:v},null,8,["modelValue"]),u(g,{modelValue:s(l).quality,"onUpdate:modelValue":o[1]||(o[1]=a=>s(l).quality=a),options:T,onChange:v},null,8,["modelValue"]),u(g,{modelValue:s(l).race,"onUpdate:modelValue":o[2]||(o[2]=a=>s(l).race=a),options:U,onChange:v},null,8,["modelValue"])]),_:1})):b("",!0)]),_:1}),n("div",ve,[n("div",ge,[_e,n("span",fe,f(s(t).totalnft),1)]),n("div",ye,"\u5171"+f(s(t).total)+"\u6761\uFF0C\u6BCF\u9875"+f(s(t).limit)+"\u6761\uFF0C\u5F53\u524D\u7B2C"+f(s(t).page)+"\u9875",1)]),u(p,{modelValue:N.value,"onUpdate:modelValue":o[3]||(o[3]=a=>N.value=a),onRefresh:$},{default:_(()=>[n("div",be,[(d(!0),V(P,null,Q(s(t).nfts,(a,z)=>(d(),k(pe,{key:"nft"+z,title:i.$t(a.name),thumb:"/static/images/"+a.code+".png",amount:a.amount,quality:a.quality,level:a.level,race:a.race,lvPower:a.lvPower,className:a.class,source:a.source,code:a.code,tokenId:a.tokenId},null,8,["title","thumb","amount","quality","level","race","lvPower","className","source","code","tokenId"]))),128))])]),_:1},8,["modelValue"]),s(t).total>0?(d(),k(B,{key:0,modelValue:s(t).page,"onUpdate:modelValue":o[4]||(o[4]=a=>s(t).page=a),"total-items":s(t).total,"items-per-page":s(t).limit,"show-page-size":3,"force-ellipses":"",onChange:r},null,8,["modelValue","total-items","items-per-page"])):b("",!0)],64)}}});export{ke as default};
